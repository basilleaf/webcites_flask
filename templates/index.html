<!DOCTYPE>
<html>
    <head>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="static/style.css">
    <link href='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css' rel='stylesheet' />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script>$(document).ready(function(){
        $('#button').click(function() {
            url = '/locations/'+$("#bibinput").val();
            $('#gif').toggle();
            $.getJSON(url, function(data) {
                $('#gif').toggle();

                var marker = L.marker(data["coords"]).addTo(map);
                    marker.bindPopup("This is the first author's institution").togglePopup();
                
                var coauthors = [];

                for (var i =0; i < data["coa_coords"].length; i++) {
                    coauthors.push(L.marker(data["coa_coords"][i]))
                }           


                var coauthors = L.layerGroup(coauthors);

                var basicMaps = {
                    "First Author Institute(s)":marker 
                };
                
                var overlayMaps = {
                     "Co-author Institutions": coauthors
                    };
                L.control.layers(basicMaps, overlayMaps).addTo(map);

            });
        });
    });
    </script>
    </head>
    <body>
    <h1>Interactive geo citation webs</h1>
    <div> 

        <input type="text" name="BIBCODE" value="2015MNRAS.450..435S" id="bibinput">
        <button id="button">load</button>

    </div>
    <div id="gif"><img src="static/loading.gif"></div>
    <div id="map" style="width: 100%; height: 90%"></div>

    <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
    <script src='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js'></script>
    <script src="leaflet.js"></script>
    <script src="Leaflet.Geodesic.js"></script>
    <script>
        var map = L.map('map').setView([0, 0], 2);
        
        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
        maxZoom: 18,
        id: 'mapbox.streets',
        accessToken: 'pk.eyJ1IjoicmpzbWV0aHVyc3QiLCJhIjoiY2lnbG56YnplMDE0M3RjbTNkems5cWI0aCJ9.ekUxiCzi_8dwkUinlpr1YQ'
        }).addTo(map);

        
        

        
    </script>
    </body>
</html>